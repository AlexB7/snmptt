<!DOCTYPE doctype PUBLIC "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
  <meta http-equiv="Content-Type"
 content="text/html; charset=iso-8859-1">
  <meta name="Author" content="Alex  Burger">
  <meta name="GENERATOR"
 content="Mozilla/4.78 [en] (Windows NT 5.0; U) [Netscape]">
  <title>SNMP Trap Translator</title>
</head>
<body>
<br>
<b><font size="+3">SNMP Trap Translator v0.6.1</font></b><br>
<b>(SNMPTT)</b> <br>
This file was last updated on:&nbsp; March 26th, 2003
<p><a href="#License">License</a> </p>
<p><a href="#What-is-it">SNMPTT</a> </p>
<blockquote><a href="#What-is-it">What is it?</a> <br>
  <a href="#Downloading">Downloading</a> <br>
  <a href="#Features">Features</a> <br>
  <a href="#Requirements">Requirements</a> <br>
  <a href="#Whats-New">What's New</a> <br>
  <a href="#Upgrading">Upgrading</a> <br>
  <a href="#Configuration-Options">Configuration Options - snmptt.ini</a> <br>
  <a href="#LoggingStandard">Logging</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#LoggingStandard">Standard</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#LoggingSyslog">Syslog</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#LoggingEventLog">EventLog</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#LoggingDatabase">Database</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#LoggingUnknown">Unknown Traps</a> <br>
  <a href="#Executing-an-external-program">Executing an external program</a> <br>
  <a href="#Modes-of-Operation">Modes of Operation</a> <br>
  <a href="#Command-line-arguments">Command line arguments</a> <br>
  <a href="#SNMPTT.CONF-Configuration-file-format">SNMPTT.CONF
Configuration file format</a> <br>
  <a href="#SNMPTT.CONF-Configuration-file-Notes">SNMPTT.CONF
Configuration file Notes</a> <br>
  <a href="#Sample1-SNMPTT.CONF-file">Sample1 SNMPTT.CONF file</a> <br>
  <a href="#Sample2-SNMPTT.CONF-file">Sample2 SNMPTT.CONF file</a> <br>
  <a href="#Notes">Notes</a> <br>
  <a href="#Installation-Unix">Installation</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#Installation-Unix">Unix</a> <br>
  <b>&nbsp;&nbsp; </b><a href="#Installation-Windows">Windows</a> <br>
  <a href="#Limitations">Limitations</a> <br>
  <a href="#Feedback">Feedback &amp; Bugs</a></blockquote>
<a href="#SNMP-Trap-Translator-Convert">SNMP Trap Translator Convert</a>
<p><a href="#SNMP-Trap-Translator-Convert-MIB">SNMP Trap Translator
Convert MIB</a> </p>
<p><a href="#FAQ-Troubleshooting">FAQ / Troubleshooting</a> <br>
&nbsp; <br>
&nbsp; </p>
<p><a name="License"></a><b><font size="+2">License</font></b> </p>
<p>Copyright 2002 Alex Burger <br>
alex_b@users.sourceforge.net <br>
4/3/2002 </p>
<p>This program is free software; you can redistribute it and/or modify <br>
it under the terms of the GNU General Public License as published by <br>
the Free Software Foundation; either version 2 of the License, or <br>
(at your option) any later version. </p>
<p>This program is distributed in the hope that it will be useful, <br>
but WITHOUT ANY WARRANTY; without even the implied warranty of <br>
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.&nbsp; See the <br>
GNU General Public License for more details. </p>
<p>You should have received a copy of the GNU General Public License <br>
along with this program; if not, write to the Free Software <br>
Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA&nbsp;
02111-1307&nbsp; USA <br>
&nbsp; </p>
<p><a name="What-is-it"></a><b><font size="+2">What is it?</font></b> </p>
<p>SNMPTT (SNMP Trap Translator) is a SNMP trap handler written in Perl
for use with the NET-SNMP / UCD-SNMP snmptrapd program (<a
 href="http://www.net-snmp.org">http://www.net-snmp.org)</a>. </p>
<p>The NET-SNMP package has the ability to log SNMP traps to
syslog.&nbsp; The format of the log is basically variable = value,
variable = value, variable = value etc.&nbsp; A more descriptive /
friendly trap message can be created using SNMPTT's variable
substitution. </p>
<p>For example, receiving the trap .1.3.6.1.4.1.232.0.3017 from a
Compaq server running the Compaq Insight Agents could result in the
following message from SNMPTT: </p>
<p>"Compaq Drive Array Spare Drive on controller 3, bus 0, bay 3 status
is Failed." </p>
<p>Variable substation works by defining a string such as: </p>
<p>"Compaq Drive Array Spare Drive on controller $4, bus $5, bay $6
status is $3." </p>
<p>Each $<i>number</i> is replaced with the corresponding enterprise
variable received in the trap and is defined for each trap in the
configuration file.&nbsp; The order of the variables is defined in the
MIB or TRAP file which can be obtained from the vendor. <br>
&nbsp; </p>
<p><a name="Downloading"></a><b><font size="+2">Downloading</font></b> </p>
<p>SNMPTT can be downloaded from <a
 href="http://www.sourceforge.net/projects/snmptt">http://www.sourceforge.net/projects/snmptt</a> <br>
&nbsp; </p>
<p><a name="Features"></a><b><font size="+2">Features</font></b> </p>
<ul>
  <li> Allows unique custom actions for each trap, defined in a text
configuration file</li>
  <li> Translates received traps into a readable format by performing
variable substitution</li>
  <li> Outputs translated traps to standard output, text log file,
syslog, NT Event Log, MySQL, or any database support by the DBD::ODBC or
Win32::ODBC modules</li>
  <li> Executes a user defined program when a trap is received</li>
</ul>
<p><br>
<a name="Requirements"></a><b><font size="+2">Requirements</font></b> </p>
<ul>
  <li> (Developed using) Perl 5.6.1</li>
  <li> Required: <a href="http://www.net-snmp.org">NET-SNMP</a>
(formerly known as UCD-SNMP).&nbsp; Specifically <b>snmptrapd</b></li>
  <li> Required: <a
 href="http://search.cpan.org/search?module=Text::ParseWords">Text::ParseWords</a>
(included with most distributions including ActivePerl)</li>
  <li> Required: <a
 href="http://search.cpan.org/search?module=Getopt::Long">Getopt::Long</a>
(included with most distributions including ActivePerl)</li>
  <li> Required: Posix (included with most if not all distributions
including ActivePerl)</li>
  <li> Required: <a
 href="http://search.cpan.org/search?module=Config::IniFiles">Config::IniFiles</a></li>
  <li> Required: <a
 href="http://search.cpan.org/search?module=Time::HiRes">Time::HiRes</a>
(only required when using SNMPTT in daemon mode - required by <b>snmptthandler</b>)</li>
  <li> Optional: <a
 href="http://search.cpan.org/search?module=Sys::Syslog">Sys::Syslog</a>
module (included with most Unix distributions)</li>
  <li> Optional: <a href="http://search.cpan.org/search?module=DBI">DBI</a>
module.&nbsp; Required for DBD::MySQL, DBD::ODBC<br>
  </li>
  <li> Optional: <a
 href="http://search.cpan.org/search?module=DBD::mysql">DBD::mysql</a>
module.&nbsp; Required for MySQL support<br>
  </li>
  <li> Optional: <a
 href="http://search.cpan.org/search?module=DBD::PgPP">DBD::PgPP</a>
module.&nbsp; Required for PostgreSQL support<br>
  </li>
  <li> Optional: <a
 href="http://search.cpan.org/search?module=DBD::ODBC">DBD::ODBC</a>
module.&nbsp; Required for ODBC (SQL etc) access on Linux / Windows
(Win32::ODBC not required if using DBD::ODBC)</li>
  <li> Optional: <a
 href="http://search.cpan.org/search?module=Win32::ODBC">Win32::ODBC</a>
module.&nbsp; Required for ODBC (SQL etc) access on Windows (DBD::ODBC
not required if using Win32::ODBC)</li>
  <li> Optional: <a
 href="http://www.net-snmp.org/FAQ.html#Where_can_I_get_the_perl_SNMP_package_">NET-SNMP
Perl module</a>.&nbsp; Only required to translate variable names ($vn)
or if translation of integers is enabled</li>
</ul>
All development and testing was done on Mandrake Linux 8.1 using
UCD-SNMP v4.2.1 (package ucd-snmp-4.2.1-5mdk.i586.rpm).&nbsp; I have
also tested the program with Windows 2000 using NET-SNMP.&nbsp; Both
SNMP V1 and V2 traps have been tested.
<p>UCD-SNMP v4.2.3 appears to have a bug that prevents it from working
correctly with SNMPTT.&nbsp; UCD-SNMP v4.2.1, v4.2.4 and v4.2.5 appear
to work fine.&nbsp; If you need to use UCD-SNMP v4.2.3 (for example you
are using the Compaq supplied UCD-SNMP package) then you should at the
very least use the <b>snmptrapd</b> program from v4.2.5.&nbsp; Net-SNMP
does not have this problem.<br>
</p>
<p>Note: </p>
<blockquote>SNMPTT only requies the the NET-SNMP Perl module if you
want to have variable names translated into text, or you enable the
translation of integer values (translate_integers = 1) to enumeration
tags.</blockquote>
<p><br>
<a name="Whats-New"></a><b><font size="+2">What's New</font></b> </p>
<p><b><font size="+1">0.7 - ??</font></b><b><font size="+1">, 2003</font></b></p>
<ul>
  <li>Postgres SQL support via DBI / DBD::PgPP <br>
  </li>
</ul>
<p><br>
<b><font size="+1">0.6 - March </font></b><b><font size="+1">25th, 2003</font></b></p>
<ul>
  <li>Logging:</li>
  <ul>
    <li> Added support for logging of traps using DBD::ODBC</li>
    <li> Fixed bug with Win32::ODBC connection not being closed on exit
of SNMPTT</li>
    <li> MySQL code cleanup</li>
    <li> Added support for logging traps to the NT Event Log including
the ability to select the Event Log level based on the severity level
defined in the <span style="font-weight: bold;">snmptt.conf</span> file</li>
    <li> Improved syslog support by adding the ability to select the
syslog level based on the severity level defined in the <span
 style="font-weight: bold;">snmptt.conf</span> file</li>
    <li> Added syslog and NT Event Log support for SNMPTT 'system'
events such as startup, shutdown, errors handling spool directory /
files, database connectivity errors etc</li>
    <li> Added the option <b>keep_unlogged_traps</b> to have SNMPTT
erase the spooled trap file only after it successfully logs to at least
one or all log systems.&nbsp; This will help prevent traps from being
lost due to logging problems.</li>
  </ul>
  <li> Added ability to translate integer values to enumeration tags
defined in MIB files.&nbsp; This feature requires the UCD-SNMP /
NET-SNMP Perl module</li>
  <li> Added new variable substitutions: <b>$v<i>n</i></b> (variable
name), <b>$+<i>n</i></b>(variable name:value), <b>$-<i>n</i></b>
(variable name (type):value), <b>$+*</b> (same as $+<i>n</i> but
wildcard), and <b>$-*</b> (same as $-<i>n</i> but wildcard).&nbsp;
Translation of the variable name using the MIB requires the UCD-SNMP /
NET-SNMP Perl module.</li>
  <li> If a variable is passed from snmptrapd that is blank, snmptt will
replace it with <span style="font-weight: bold;">(null)</span></li>
  <li>Fixed bug that would prevent variables numbered 10 or higher from
being translated correctly</li>
  <li> Fixed bug with handling trap data that contains spaces but is not
inside of quotes</li>
  <li>Code cleanup to remove Perl warnings (-w)</li>
  <li>Added separate debug file for snmptthandler</li>
  <li> Cleaned up defaults code for snmptthandler</li>
  <li>Added examples folder containg a sample snmptt.conf file and
sample trap file</li>
  <li>Added FAQ section to this document</li>
  <li>Snmpttconvertmib</li>
  <ul>
    <li>Code cleanup</li>
    <li>Now uses new command line arguments (<span
 style="font-weight: bold;">snmpttconvertmib -h</span> for help).</li>
    <li>Can now use either <span style="font-weight: bold;">snmptranslate</span>or
the SNMP Perl module (NET-SNMP) to process MIB files</li>
    <li>Can now add a NODES line when converting MIB files</li>
    <li> Now checks the version of <span style="font-weight: bold;">snmptranslate</span>
before converting the mib to ensure <span style="font-weight: bold;">snmptranslate</span>
is called correctly</li>
    <li> Fixed bug which would cause the last notification of a v2 MIB
file not to be converted correctly</li>
  </ul>
</ul>
<b><font size="+1"><br>
0.5 - February 12th, 2003</font></b>
<ul>
  <li> Spool file list sorted before processing to ensure traps are
processed in the order they are received when in daemon mode</li>
  <li> Added <b>use_trap_time </b>variable to config file for daemon
mode to have SNMPTT use either the time from the spool file, or the
current time.&nbsp; Changed SNMPTTHANDLER to output the current date and
time on the first line of the spool file</li>
  <li> Fixed bug with default variable settings being ignored.&nbsp;
Defaults were not being set correctly if variable was not defined in the
.ini file.</li>
  <li> Fixed bug with SNMPTT ignoring the daemon mode parameter in the
.ini file</li>
  <li> Fixed bug with Nodes list not being flushed out for each
processed trap when running in daemon mode</li>
  <li> Added <b>strip_domain</b> and <b>strip_domain_list</b>
configuration options to enable / disable the removal of the domain name
from the host name passed to SNMPTT.&nbsp; Defaults to disabled (do
not&nbsp; strip domain name)</li>
  <li> SNMPTTCONVERTMIB now prepends the contents of the --#TYPE line
(if present) to the --#SUMMARY line to provide a more descriptive FORMAT
/ EXEC line</li>
</ul>
<b><font size="+1">0.4 - November 18th, 2002</font></b>
<ul>
  <li> Variable substitution changes:</li>
  <ul>
    <li> $X = Date, $x = Time instead of $x being both date and time</li>
    <li> $N = Event name instead of $S</li>
    <li> Added $c, $@, $O, $o, $ar, $R, $aR, $G, $S</li>
  </ul>
  <li> Configuration moved to a .ini file</li>
  <li> MySQL support via DBI under Linux and Windows</li>
  <li> ODBC support via Win32::ODBC under Windows</li>
</ul>
<b><font size="+1">0.3 - September 11th, 2002</font></b>
<ul>
  <li> Daemon mode support for SNMPTT.&nbsp; When running as a daemon,
SNMPTTHANDLER script is used to spool traps from SNMPTRAPD.</li>
  <li> SNMPTTCONVERTMIB utility to convert trap / notify definitions
from MIB files</li>
  <li> Sample trap file (sample-trap) for testing</li>
  <li> Command line options to SNMPTT</li>
  <li> SNMPTT now strips UDP: and :<i>port</i> from IP addresses when
using NET-SNMP 5.0+</li>
  <li> NODES files can now contain comments</li>
  <li> NODES files can now contain either host names or IP addresses</li>
  <li> You can now have multiple definitions of the same trap so that
different hosts / nodes can have different actions or one host have
multiple actions</li>
  <li> Configuration file can now contain a list of other configuration
files to load</li>
</ul>
<b><font size="+1">0.2 - July 10th, 2002</font></b>
<ul>
  <li> Improved debugging output</li>
  <li> Severity substitution bug fix</li>
  <li> SNMP V2 trap bug fix</li>
  <li> UCD-SNMP v4.2.3 problem workaround</li>
</ul>
<b><font size="+1">0.1 - April 18th, 2002</font></b>
<ul>
  <li> Initial release</li>
</ul>
<p><br>
<a name="Upgrading"></a><b><font size="+2">Upgrading</font></b> <br>
&nbsp; </p>
<p><b><font size="+1">v0.5 to v0.6</font></b> </p>
<p>To upgrade from v0.5 to v0.6, you should: </p>
<ol>
  <li> Replace <b>SNMPTTHANDLER, SNMPTT</b> and <b>SNMPTTCONVERTMIB</b>
with the new versions contained in the v0.6 package</li>
  <li> Backup your <b>snmptt.ini </b>file, replace it with the new
version, and make any necessary configuration changes to it</li>
  <li> Enable any new features in <span style="font-weight: bold;">snmptt.ini</span>
as required</li>
  <li> Test and report any issues to alex_b@users.sourceforge.net, or
open a bug report at <a
 href="http://sourceforge.net/tracker/?group_id=51473&amp;atid=463393">Sourceforge</a>.<br>
  </li>
</ol>
<b><font size="+1">v0.4 to v0.5</font></b>
<p>To upgrade from v0.1, v0.2 to v0.3 to v0.4, you should: </p>
<ol>
  <li> Set <b>use_trap_time</b> to<b> 0</b> to have SNMPTT operate the
same as v0.4, or leave as 1 (recommended default) and test</li>
  <li> Replace <b><u>both</u></b> <b>SNMPTTHANDLER</b> and <b>SNMPTT</b>
with the new versions contained in the v0.5 package</li>
  <li> Backup your <b>snmptt.ini</b> file, replace it with the new
version, and make any necessary configuration changes to it</li>
</ol>
<b><font size="+1">v0.1, v0.2 or v0.3 to v0.4</font></b>
<p>To upgrade from v0.1, v0.2 to v0.3 to v0.4, you should: </p>
<ol>
  <li> In your snmptt.conf file, replace all <b>$x</b> with <b>$x $X</b>
(see What's New section)</li>
  <li> In your snmptt.conf file, replace all <b>$S</b> with <b>$N (</b>see
What's New section)</li>
  <li> Configure the snmptt.ini as described in this file -
configuration options are no longer stored in the snmptt and
snmptthandler scripts</li>
  <li> If your snmptt.conf file contained a list of other snmptt.conf
files instead of trap definitions, move that list to the snmptt.ini file</li>
</ol>
<p><br>
<a name="Configuration-Options"></a><b><font size="+2">Configuration
Options - snmptt.ini</font></b> </p>
<p>As mentioned throughout this document, configuration options are set
by editing the <b>snmptt.ini</b> file. </p>
<p>For Linux / Unix, the <b>snmptt.ini</b> file should be located in
either <b>/etc/snmp/</b> or <b>/etc/</b>.&nbsp; SNMPTT will search for
the the file in both directories in that order. </p>
<p>For Windows, the file should be in <b>%SystemRoot%\</b>.&nbsp; For
example, <b>c:\winnt</b>. </p>
<p>The location of the ini file can be set on the command line using
the <b>-ini=</b> parameter.&nbsp; See <a href="#Command-line-arguments">Command
Line Arguments</a>. </p>
<p>A sample <b>snmptt.ini</b> is provided in this package.&nbsp; For
Windows NT, be sure to copy the <b>snmptt.ini-nt</b> file to <b>%SystemRoot%\snmptt.ini</b>.&nbsp;
For Windows NT, be sure to remove the <span style="font-weight: bold;">-nt</span>
from the end of the filename.<br>
</p>
<p style="text-decoration: underline;"><span style="font-weight: bold;">This
readme file does not document all configuration options available in
the </span><b style="font-weight: bold;">snmptt.ini</b><span
 style="font-weight: bold;"> as the </span><b style="font-weight: bold;">snmptt.ini</b><span
 style="font-weight: bold;"> file contains detailed descriptions for
each option.<br>
</span><span style="font-weight: bold;"></span><br>
</p>
<p><a name="LoggingStandard"></a><b><font size="+2">Logging - Standard</font></b> </p>
<p>Translated traps can be sent to standard output and to a log
file.&nbsp; The output format is: </p>
<blockquote><b>date trap-oid severity category hostname translated-trap</b></blockquote>
To configure standard output or regular logging, edit the <b>snmptt.ini</b>
file and modify the following variables:
<blockquote><b>enable_stdout</b> <br>
  <b>enable_log</b> <br>
  <b>log_file</b></blockquote>
<a name="LoggingSyslog"></a><b><font size="+2">Logging - Syslog</font></b>
<p>Translated traps can also be sent to syslog.&nbsp; The format of the
entries will be similar to above without the date (as syslogd logs the
date): </p>
<blockquote><b>trap-oid severity category hostname translated-trap</b></blockquote>
To configure syslog, edit the snmptt ini file and modify the following
variables:
<blockquote><b>syslog_enable</b> <br>
  <b>syslog_facility</b> <br>
  <b>syslog_level</b></blockquote>
SNMPTT system errors can be sent to syslog by editing the snmptt.ini
file and modifying the following variables:
<blockquote><b>syslog_system_enable</b> <br>
  <b>syslog_system_facility</b> <br>
  <b>syslog_system_level</b></blockquote>
The following errors are logged:
<blockquote>SNMPTT (version) started <b>(*)</b> <br>
Unable to enter spool dir <i>x</i> <b>(*)</b> <br>
Unable to open spool dir <i>x</i> <b>(*)</b> <br>
Unable to read spool dir <i>x</i> <b>(*)</b> <br>
Could not open trap file <i>x</i> <b>(*)</b> <br>
Unable to delete trap file <i>x</i> from spool dir <b>(*)</b> <br>
Reloading configuration file(s) <b>(*)</b> <br>
SNMPTT (version) shutdown <b>(*)</b> <br>
Loading <i>snmpttconfigfile</i> <b>(*)</b> <br>
Could not open configuration file: <i>snmpttconfigfile</i><b>(*)</b> <br>
Finished loading <i>x</i> lines from <i>snmpttconfigfile</i> <b>(*)</b> <br>
MySQL error: Unable to connect to database <br>
Can not open log file <i>logfile</i> <br>
MySQL error: Unable to perform INSERT INTO <br>
DBI DBD::ODBC error: Unable to perform INSERT INTO
  <p><b>* (daemon mode only)</b></p>
</blockquote>
<a name="LoggingEventLog"></a><b><font size="+2">Logging - EventLog</font></b>
<p>Translated traps can also be sent to the NT EventLog.&nbsp; All
traps are logged under <span style="font-weight: bold;">EventID 2</span>
under the source <span style="font-weight: bold;">SNMPTT</span>.&nbsp;
The format of the entries will be similar to above without the date (as
the Event Log logs the date): </p>
<blockquote><b>trap-oid severity category hostname translated-trap</b></blockquote>
To configure eventlog support, edit the snmptt ini file and modify the
following variables:
<blockquote><b>eventlog_enable</b> <br>
  <b>eventlog_type</b></blockquote>
SNMPTT system errors can be sent to the Event Log by editing the
snmptt.ini file and modifying the following variables:
<blockquote><b>eventlog_system_enable</b></blockquote>
The following errors are logged.&nbsp; Note that each error contains a
unique <span style="font-weight: bold;">EventID</span>:<br>
<blockquote>EventID 0: SNMPTT (version) started <b>(*)</b> <br>
EventID 3: Unable to enter spool dir <i>x</i> <b>(*)</b> <br>
EventID 4: Unable to open spool dir <i>x</i> <b>(*)</b> <br>
EventID 5: Unable to read spool dir <i>x</i> <b>(*)</b> <br>
EventID 6: Could not open trap file <i>x</i> <b>(*)</b> <br>
EventID 7: Unable to delete trap file <i>x</i> from spool dir <b>(*)</b> <br>
EventID 8: Reloading configuration file(s) <b>(*)</b> <br>
EventID 1: SNMPTT (version) shutdown <b>(*)</b> <br>
EventID 9: Loading <i>snmpttconfigfile</i> <b>(*)</b> <br>
EventID 10: Could not open configuration file: <i>snmpttconfigfile</i><b>(*)</b> <br>
EventID 11: Finished loading <i>x</i> lines from <i>snmpttconfigfile</i><b>(*)</b> <br>
EventID 12: MySQL error: Unable to connect to database <br>
EventID 13: SQL error: Unable to connect to DSN <i>dsn</i> <br>
EventID 14: Can not open log file <i>logfile</i> <br>
EventID 15: MySQL error: Unable to perform INSERT INTO <br>
EventID 16: DBI DBD::ODBC error: Unable to perform INSERT INTO <br>
EventID 17: Win32::ODBC error: Unable to perform INSERT INTO<br>
EventID 18: Postgres error: Unable to connect to database <br>
EventID 19: PostgresL error: Unable to perform INSERT INTO <br>
  <p><b>* (daemon mode only)</b></p>
</blockquote>
Note:
<blockquote>To prevent "Event Message Not Found" messages in the Event
Viewer, an Event Message File must be used.&nbsp; For information on
installing the message file, see the <a
 href="#Installation%20-%20Windows">Installation section for Windows</a>.</blockquote>
<a name="LoggingDatabase"></a><b><font size="+2">Logging - Database</font></b>
<p>Translated traps can also be sent to a database.&nbsp; MySQL (tested
under Linux) and ODBC (testing under Windows NT) can be used. </p>
<p><b><font size="+1">DBD::MySQL</font></b> </p>
<p>To configure SNMPTT for MySQL, modify the following variables in the
snmptt.ini file. </p>
<blockquote><b>mysql_dbi_enable</b> <br>
  <b>mysql_dbi_database</b> <br>
  <b>mysql_dbi_table</b> <br>
  <b>mysql_dbi_username</b> <br>
  <b>mysql_dbi_password</b></blockquote>
Note:&nbsp; Sample values are defined in the default ini file.
<p>The following MySQL script can create the database and table.&nbsp;
Permissions etc should also be defined. </p>
<blockquote><b><tt>CREATE DATABASE snmptt;</tt></b> <br>
  <b><tt>USE snmptt;</tt></b>
  <p><b><tt>DROP TABLE snmptt;;</tt></b> <br>
  <b><tt>CREATE TABLE snmptt (</tt></b> <br>
  <b><tt>eventname VARCHAR(50),</tt></b> <br>
  <b><tt>eventid VARCHAR(50),</tt></b> <br>
  <b><tt>enterprise VARCHAR(50),</tt></b> <br>
  <b><tt>community VARCHAR(20),</tt></b> <br>
  <b><tt>hostname VARCHAR(100),</tt></b> <br>
  <b><tt>agentip&nbsp; VARCHAR(16),</tt></b> <br>
  <b><tt>category VARCHAR(20),</tt></b> <br>
  <b><tt>severity VARCHAR(20),</tt></b> <br>
  <b><tt>uptime&nbsp; VARCHAR(20),</tt></b> <br>
  <b><tt>traptime VARCHAR(30),</tt></b> <br>
  <b><tt>formatline VARCHAR(255));</tt></b></p>
</blockquote>
All variables are INSERTted into the database as standard text
including the date and time.&nbsp; The variable lengths I have chosen
above should be sufficient, but they may need to be increased depending
on your environment.<br>
<br>
<p><b><font size="+1">DBD::PgPP (Postgres)<br>
</font></b></p>
<p>To configure SNMPTT for Postgres, modify the following variables in
the snmptt.ini file. </p>
<blockquote><b>postgres_dbi_enable</b> <br>
  <b>postgres</b><b>_dbi_database</b> <br>
  <b>postgres</b><b>_dbi_table</b> <br>
  <b>postgres</b><b>_dbi_username</b> <br>
  <b>postgres</b><b>_dbi_password</b></blockquote>
Note:&nbsp; Sample values are defined in the default ini file.
<p>The following Postgres script can create the database and table (not
tested!).&nbsp; Permissions etc should also be defined. </p>
<blockquote><b><tt>CREATE DATABASE snmptt;</tt></b> <br>
  <b><tt>USE snmptt;</tt></b>
  <p><b><tt>DROP TABLE snmptt;;</tt></b> <br>
  <b><tt>CREATE TABLE snmptt (</tt></b> <br>
  <b><tt>eventname VARCHAR(50),</tt></b> <br>
  <b><tt>eventid VARCHAR(50),</tt></b> <br>
  <b><tt>enterprise VARCHAR(50),</tt></b> <br>
  <b><tt>community VARCHAR(20),</tt></b> <br>
  <b><tt>hostname VARCHAR(100),</tt></b> <br>
  <b><tt>agentip&nbsp; VARCHAR(16),</tt></b> <br>
  <b><tt>category VARCHAR(20),</tt></b> <br>
  <b><tt>severity VARCHAR(20),</tt></b> <br>
  <b><tt>uptime&nbsp; VARCHAR(20),</tt></b> <br>
  <b><tt>traptime VARCHAR(30),</tt></b> <br>
  <b><tt>formatline VARCHAR(255));</tt></b></p>
</blockquote>
All variables are INSERTted into the database as standard text
including the date and time.&nbsp; The variable lengths I have chosen
above should be sufficient, but they may need to be increased depending
on your environment.<br>
<br>
<p><b><font size="+1">DBD::ODBC</font></b> </p>
<p>SNMPTT can access ODBC data sources using either the DBD::ODBC
module on Linux and Windows, or the WIN32::ODBC module on Windows. </p>
<p>To configure SNMPTT for ODBC access using the module DBD::ODBC,
modify the following variables in the snmptt script. </p>
<blockquote><b>dbd_odbc_enable = 1;</b> <br>
  <b>dbd_odbc_dsn = 'snmptt';</b> <br>
  <b>dbd_odbc_table = 'snmptt';</b> <br>
  <b>dbd_odbc_username = 'snmptt';</b> <br>
  <b>dbd_odbc_password = 'password';</b></blockquote>
Note:&nbsp; <br>
<div style="margin-left: 40px;">SNMPTT does not create the DSN
connection.&nbsp; You must define the DSN outside of SNMPTT.<br>
<br>
Sample values are defined in the default ini file. </div>
<p>The following MS SQL Server script can create the table inside an
existing database.&nbsp; Permissions etc should also be defined. </p>
<blockquote><b><tt>CREATE TABLE snmptt (</tt></b> <br>
  <b><tt>eventname character(50) NULL,</tt></b> <br>
  <b><tt>eventid&nbsp; character(50) NULL,</tt></b> <br>
  <b><tt>enterprise character(50) NULL,</tt></b> <br>
  <b><tt>community character(20) NULL,</tt></b> <br>
  <b><tt>hostname character(100) NULL,</tt></b> <br>
  <b><tt>agentip&nbsp; character(16) NULL,</tt></b> <br>
  <b><tt>category character(20) NULL,</tt></b> <br>
  <b><tt>severity character(20) NULL,</tt></b> <br>
  <b><tt>uptime&nbsp; character(20) NULL,</tt></b> <br>
  <b><tt>traptime character(30) NULL,</tt></b> <br>
  <b><tt>formatline character(255) NULL)</tt></b></blockquote>
All variables are inserted into the database using '<b>INSERT INTO</b>'
as text including the date and time.&nbsp; The variable lengths I have
chosen above should be sufficient, but they may need to be increased
depending on your environment. <br>
&nbsp;
<p><b><font size="+1">Win32::ODBC</font></b> </p>
<p>SNMPTT can access ODBC data sources using either the DBD::ODBC
module on Linux and Windows, or the WIN32::ODBC module on Windows. </p>
<p>To configure SNMPTT for MS SQL via ODBC on Windows, modify the
following variables in the snmptt script. </p>
<blockquote><b>sql_win32_odbc_enable = 1;</b> <br>
  <b>sql_win32_odbc_dsn = 'snmptt';</b> <br>
  <b>sql_win32_odbc_table = 'snmptt';</b> <br>
  <b>sql_win32_odbc_username = 'snmptt';</b> <br>
  <b>sql_win32_odbc_password = 'password';</b></blockquote>
Note:&nbsp; <br>
<div style="margin-left: 40px;">SNMPTT does not create the DSN
connection.&nbsp; You must define the DSN outside of SNMPTT.<br>
<br>
Sample values are defined in the default ini file. </div>
<p>The following MS SQL Server script can create the table inside an
existing database.&nbsp; Permissions etc should also be defined. </p>
<blockquote><b><tt>CREATE TABLE snmptt (</tt></b> <br>
  <b><tt>eventname character(50) NULL,</tt></b> <br>
  <b><tt>eventid&nbsp; character(50) NULL,</tt></b> <br>
  <b><tt>enterprise character(50) NULL,</tt></b> <br>
  <b><tt>community character(20) NULL,</tt></b> <br>
  <b><tt>hostname character(100) NULL,</tt></b> <br>
  <b><tt>agentip&nbsp; character(16) NULL,</tt></b> <br>
  <b><tt>category character(20) NULL,</tt></b> <br>
  <b><tt>severity character(20) NULL,</tt></b> <br>
  <b><tt>uptime&nbsp; character(20) NULL,</tt></b> <br>
  <b><tt>traptime character(30) NULL,</tt></b> <br>
  <b><tt>formatline character(255) NULL)</tt></b></blockquote>
All variables are inserted into the database using '<b>INSERT INTO</b>'
as text including the date and time.&nbsp; The variable lengths I have
chosen above should be sufficient, but they may need to be increased
depending on your environment. <br>
&nbsp;
<p><a name="LoggingUnknown"></a><b><font size="+2">Logging - Unknown
traps</font></b> </p>
<p>Logging of non recognized traps is also possible.&nbsp; This would
be used mainly for troubleshooting purposes. </p>
<p>To configure unknown trap logging, edit the snmptt.ini file and
modify the following variables: </p>
<blockquote><b>enable_unknown_trap_log</b> <br>
  <b>unknown_trap_log_file</b></blockquote>
<p><br>
<a name="Executing-an-external-program"></a><b><font size="+2">Executing
an external program</font></b> </p>
<p>An external program can be launched when a trap is received.&nbsp;
The command line is defined in the configuration file.&nbsp; For
example, to send a page using QPAGE (<a href="http://www.qpage.org">http://www.qpage.org</a>),
the following command line could be used: </p>
<blockquote><b>qpage -f TRAP notifygroup1 "$r $x $X Compaq Drive Array
Spare Drive on controller $4, bus $5, bay $6 status is $3."</b></blockquote>
$r is translated to the hostname, and $x is the current date, and $X is
the current time (described in detail below)
<p>To enable or disable the execution of EXEC definitions, edit the
snmptt.ini file and modify the following variable: </p>
<blockquote><b>exec_enable</b></blockquote>
<p><br>
<a name="Modes-of-Operation"></a><b><font size="+2">Modes of Operation</font></b> </p>
<p>SNMPTT can be run in two modes:&nbsp; standalone mode and daemon
mode. </p>
<p><b><font size="+1">Standalone mode</font></b> </p>
<p>To use SNMPTT in standalone mode, the <span
 style="font-weight: bold;">snmptrapd.conf</span> file would contain a <span
 style="font-weight: bold;">traphandle </span>statement such as: </p>
<blockquote><b>traphandle default /usr/sbin/snmptt</b></blockquote>
When a trap is received by SNMPTRAPD, the trap is passed to the <b>/usr/sbin/snmptt</b>
script.&nbsp; SNMPTT performs the following tasks:
<ul>
  <li> reads trap passed from snmptrapd</li>
  <li> loads configuration file(s) containing trap definitions</li>
  <li> searches traps for a match</li>
  <li> logs, executes EXEC statement etc</li>
  <li> quits</li>
</ul>
With a 450 Mhz PIII and a 9000 line snmptt.conf containing 566 unique
traps (EVENTs), it takes under a second to process the trap including
logging and executing the qpage program.&nbsp; The larger the
snmptt.conf file is, the longer it will take to process.&nbsp; If there
are a large number of traps being received, daemon mode should be
used.&nbsp; If it takes 1 second to process one trap, then obviously you
shouldn't try to process more than one trap per second.
<p>Running SNMPTT without the <b>--daemon</b> command line option will
result standalone mode unless the <b>mode</b> variable in the <b>snmptt.ini</b>
file is set to <b>daemon</b>.&nbsp; For standalone mode, the <b>mode</b>
variable in the <b>snmptt.ini</b> file should be set <b>standalone</b>.<br>
</p>
<p>Note: Enabling the UCD-SNMP / Net-SNMP Perl module will greatly
increase the startup time of SNMPTT.&nbsp; Daemon mode is recommended.<br>
</p>
<p><b><font size="+1">Daemon mode</font></b> </p>
<p>When SNMPTT is run in daemon m ode, the <span
 style="font-weight: bold;">snmptrapd.conf</span> file would contain a <span
 style="font-weight: bold;">traphandle </span>statement such as: </p>
<blockquote><b>traphandle default /usr/sbin/snmptthandler</b></blockquote>
When a trap is received by SNMPTRAPD, the trap is passed to the <span
 style="font-weight: bold;">/usr/sbin/snmptthandler</span> script.&nbsp;
SNMPTTHANDLER performs the following tasks:
<ul>
  <li> reads trap passed from snmptrapd</li>
  <li> writes the trap in a new unique file to a spool directory such as
/var/spool/snmptt</li>
  <li> quits</li>
</ul>
SNMPTT running in daemon mode performs the following tasks:
<ul>
  <li> loads configuration file(s) containing trap definitions at startup</li>
  <li> reads traps passed from spool directory</li>
  <li> searches traps for a match</li>
  <li> logs, executes EXEC statement etc</li>
  <li> sleeps for 5 seconds (configurable)</li>
  <li> loops back up to 'reads traps passed from spool directory'</li>
</ul>
Using SNMPTTHANDLER and SNMPTT in daemon mode, a large number of traps
per minute should be handled easily.
<p>Running SNMPTT with the <span style="font-weight: bold;">--daemon</span>
command line option or setting the<b> mode</b> variable in the <b>snmptt.ini</b>
file to <b>daemon</b> will cause SNMPTT to run in daemon mode. </p>
<p>By setting the .ini variable <b>use_trap_time</b> to <b>1</b>
(default), the date and time used for logging etc will be the date and
time passed inside the trap spool file.&nbsp; If <b>use_trap_time</b> is
set to <b>0</b>, the date and time that the trap was <i>processed</i>
by SNMPTT is used.&nbsp; Setting <b>use_trap_time</b> to <b>0</b> can
result in inaccurate time stamps in log files due to the length of time
SNMPTT sleeps between spool directory polling. </p>
<p>Note:&nbsp; When running on a <b>non</b> Windows platform, SNMPTT
will fork to the background if <b>daemon_fork</b> is set to 1. <br>
&nbsp; </p>
<p><a name="Command-line-arguments"></a><b><font size="+2">Command line
arguments</font></b> </p>
<p>The following command line arguments are supported: </p>
<p>Usage: <br>
&nbsp;&nbsp;&nbsp; snmptt [&lt;options&gt;] <br>
Options: <br>
&nbsp;&nbsp;&nbsp;
--daemon&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Start in daemon mode <br>
&nbsp;&nbsp;&nbsp;
--debug=n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Set debug level (1 or 2) <br>
&nbsp;&nbsp;&nbsp; --debugfile=filename&nbsp;&nbsp;&nbsp; Set debug
output file <br>
&nbsp;&nbsp;&nbsp;
--dump&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Dump (display) defined traps <br>
&nbsp;&nbsp;&nbsp;
--help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Display this message <br>
&nbsp;&nbsp;&nbsp;
--ini=filename&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Specify path to snmptt.ini file <br>
&nbsp;&nbsp;&nbsp;
--version&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Display author and version information <br>
&nbsp;&nbsp;&nbsp;
--time&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Use to see how long it takes to load and <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
process trap file (eg: time snmptt --time) <br>
&nbsp; </p>
<p><a name="SNMPTT.CONF-Configuration-file-format"></a><b><font
 size="+2">SNMPTT.CONF Configuration file format</font></b> </p>
<p>The configuration file (usually /etc/snmp/snmptt.conf or
c:\snmp\snmptt.conf) contains a list of all the defined traps. </p>
<p>If your snmptt.conf file is getting rather large and you would like
to divide it up into many smaller files, then do the following: </p>
<p>-create additional snmptt.conf files <br>
-add the file names to the <b>snmptt_conf_files</b> section in the
snmptt.ini file. </p>
<p>For example: </p>
<blockquote>snmptt_conf_files = &lt;&lt;END <br>
/etc/snmp/snmptt.conf.generic<br>
/etc/snmp/snmptt.conf.compaq<br>
/etc/snmp/snmptt.conf.cisco<br>
/etc/snmp/snmptt.conf.hp <br>
/etc/snmp/snmptt.conf.3com<br>
END</blockquote>
The syntax of the snmptt.conf file&nbsp; is:
<blockquote><b>EVENT</b> event_name event_OID "category" severity
  <p><b>FORMAT</b> format_string </p>
  <p>[<b>EXEC</b> command_string] </p>
  <p>[<b>NODES</b> sources_list] </p>
  <p>[<b>SDESC</b>] <br>
[<b>EDESC</b>] </p>
  <p>Note: Lines starting with a # will be ignored. </p>
  <p>Note:&nbsp; The EVENT and FORMAT line are REQUIRED.&nbsp; Commands
in [] are optional.&nbsp; Do NOT include the []s in the configuration
file!</p>
</blockquote>
<blockquote><b>EVENT:</b>
  <blockquote><b>EVENT</b> event_name event_OID "category" severity
    <p><b>event_name:</b> </p>
    <blockquote>Unique text label (alias) <b><u>containing no spaces</u></b>.&nbsp;
This would match the name on the TRAP-TYPE or NOTIFICATION-TYPE line in
the MIB file when converted using <b>snmpttconvertmib</b>.</blockquote>
    <b>event_OID:</b>
    <blockquote>Object identifier string in dotted format notation <b><u>containing
no spaces</u></b> as received by snmptrapd.
      <p>For example, a Compaq (enterprise 1.3.6.1.4.1.232)
cpqHoGenericTrap trap (trap 11001) would be written as: </p>
      <p>1.3.6.1.4.1.232.0.11001. </p>
      <p><b>Note:</b> </p>
      <blockquote>SNMP V1 traps are in the format of enterprise ID
(1.3.6.1.4.1.232) followed by a 0, and then followed by the trap number
(11001).
        <p>There can be multiple entries for the same trap OID in the
configuration file.&nbsp; If <b>multiple_event</b> is enabled in the <span
 style="font-weight: bold;">snmptt.ini</span>, then it will process all
matching traps.&nbsp; If <b>multiple_event</b> is disabled, only the
first matching entry will be used.</p>
      </blockquote>
Wildcards can also be used.&nbsp; For example:
      <p>1.3.6.1.4.1.232.1.2.* </p>
      <p><b>Note:</b> </p>
      <blockquote>Specific trap matches are performed before wildcards
so if you have an entry for 1.3.6.1.4.1.232.1.2.5 AND
1.3.6.1.4.1.232.1.2.*, it will process the .5 trap when received even if
the wildcard is defined first.
        <p>Wildcard matches are only matched if there are NO exact
matches.&nbsp; This takes into consideration the NODES list.&nbsp;
Therefore, if there is a matching trap, but the NODES list prevents it
from being considered a match, the wildcard entry will only be used if
there are no other exact matches.</p>
      </blockquote>
    </blockquote>
    <b>category:</b>
    <blockquote>Character string enclosed in double "s.&nbsp; Used when
logging output (see above).
      <p>If the category is "<b>IGNORE</b>", no action will take place
even if the snmptt.conf contains FORMAT and / or EXEC statements. </p>
      <p>If the category is "<b>LOGONLY</b>", the trap will be logged
as usual, but the EXEC statement will be ignored. </p>
      <p>Note:&nbsp;&nbsp; If you plan on using an external program
such as Netsaint for logging, paging etc, you probably do not want any
traps defined with <b>LOGONLY</b> as the <span
 style="font-weight: bold;">EXEC </span>line would never be used to
submit the passive service check.</p>
    </blockquote>
    <b>severity:</b>
    <blockquote>Character string of the severity of the event.&nbsp;
Used in the output when logging.&nbsp; Example: Minor, Major, Normal,
Critical, Warning.&nbsp; The <b>snmptt.ini</b> contains options to match
the syslog level or NT Event Log type to the severity level.</blockquote>
  </blockquote>
  <b>FORMAT:</b>
  <blockquote><b>FORMAT</b> format_string
    <p>The format string is used to generate the text that will be
logged to any of the supported logging methods. </p>
    <p>Variable substitution is performed on this string using the
following variables: </p>
    <blockquote>$A, $aA - Trap agent IP address <br>
$c - Category <br>
$C - Trap community string <br>
$E, $e&nbsp; - Enterprise trap OID in number format <br>
$G&nbsp; - Generic trap number (0 if enterprise trap) <br>
$S&nbsp; - Specific trap number (0 if generic trap) <br>
$N&nbsp; - Event name defined <br>
$O, $o - Trap OID in number format <br>
$R, $r&nbsp; - Hostname <b>(*)</b> <br>
$aR, $ar - IP address <br>
$s&nbsp; - Severity <br>
$T&nbsp; - Uptime:&nbsp; Time since network entity was initialized <br>
$X&nbsp; - Current time <br>
$x&nbsp; - Current date <br>
$# - Number of (how many) variable-bindings in the trap <br>
$$&nbsp; - Print a $ <br>
$@ - Number of seconds since the epoch <br>
$<i>n</i>&nbsp; - Expand variable-binding n (1-<i>n</i>) <b>(**)</b> <br>
$+<i>n</i>&nbsp; - Expand variable-binding n (1-<i>n</i>) in the format
of <i>variable name:value</i> <b>(**) (***)</b> <br>
$-<i>n</i>&nbsp; - Expand variable-binding n (1-<i>n</i>) in the format
of <i>variable name (variable type):value</i> <b>(**) (***)</b> <br>
$v<i>n</i>&nbsp; - Expand variable name of the variable-binding n (1-<i>n</i>)<b>(***)</b> <br>
$*&nbsp; - Expand all variable-bindings <br>
$+*&nbsp; - Expand all variable-bindings in the format of <i>variable
name:value</i><b>(**) (***)</b> <br>
$-*&nbsp; - Expand all variable-bindings in the format of <i>variable
name (variable type):value</i> <b>(**) (***)</b></blockquote>
Example:
    <p>FORMAT NIC switchover to slot $3, port $4 from slot $5, port $6 </p>
    <p>Note: </p>
    <blockquote>For the text log file, the output will be formatted as:
 <blockquote><b><i>date time trap-OID severity category hostname -
format</i></b></blockquote>
For all other log files except MySQL, DBD::ODBC and Win32::ODBC, the
output will be formatted as:
      <blockquote><b><i>trap-OID severity category hostname - format</i></b></blockquote>
For MySQL, DBD::ODBC and Win32::ODBC, the <b>formatline</b> column will
contain only the <b>format</b> text.</blockquote>
* Note:
    <blockquote>If you are using DNS, the host name may resolve to the
Fully Qualified Domain Name (FQDN) by snmptrapd.&nbsp; For example:
barney.bedrock.com.
      <p>Adding an entry for the host in your /etc/hosts file or
c:\%systemroot%\system32\drivers\etc\hosts may result in snmptrapd
sending the short name instead (barney).&nbsp; You can also enable the <b>strip_domain</b>
/ <b>strip_domain_list</b> options to have SNMPTT strip the domain of
any FQDN host.&nbsp; See the <span style="font-weight: bold;">snmptt.ini</span>
file for details.</p>
    </blockquote>
** Note:
    <blockquote>If&nbsp; <b>translate_integers</b> is enabled in the <b>snmptt.ini</b>
file, SNMPTT will attempt to convert integer values received in traps
into text by performing a lookup in the MIB file.<br>
      <br>
You must have the UCD-SNMP / NET-SNMP Perl module installed for this to
work and you must enable support for it by enabling <b>net_snmp_perl_enable</b>
in the snmptt.ini file. <br>
      <p>For this feature to work, you must ensure UCD-SNMP / NET-SNMP
is configured correctly with all the required MIBS.&nbsp; If the option
is enabled, but the value can not be found, the integer value will be
used.&nbsp; If the MIB files are present, but translations do not occur,
ensure UCD-SNMP / NET-SNMP is correctly configured to process all the
required mibs.&nbsp; This is configured in the UCD-SNMP / Net-SNMP <b>snmp.conf</b>
file.&nbsp; Alternatively, you can try setting the <b>mibs_enviroment</b>
variable in <b>snmptt.ini</b> to <b>ALL</b> (no quotes) to force all
MIBS to be initialized at SNMPTT startup. </p>
      <p>If <b>translate_integers</b> is enabled while using
stand-alone mode, it may take longer to process each trap due to the
initialization of the MIB files. </p>
    </blockquote>
*** Note:
    <blockquote>$v<i>n</i>, $+<i>n</i> and $-<i>n</i> variable names and
variable type are translated into the text name by performing a lookup
in the MIB file.&nbsp; You must have the UCD-SNMP / NET-SNMP Perl module
installed for this to work and you must enable support for it by
enabling <b>net_snmp_perl_enable</b> in the snmptt.ini file.&nbsp; If <b>net_snmp_perl_enable</b>
is not enabled, the $v<i>n</i> variable will be replaced with the text
'variable<i>n</i>' where <i>n</i> is the variable number (1+).
      <p>For the name translation to work, you must ensure UCD-SNMP /
NET-SNMP is configured correctly with all the required MIBS.&nbsp; If
the option is enabled and the correct name is not returned, ensure
UCD-SNMP / NET-SNMP is correctly configured to process all the required
mibs.&nbsp; This is configured in the UCD-SNMP / Net-SNMP <b>snmp.conf</b>
file.&nbsp; Alternatively, you can try setting the <b>mibs_enviroment</b>
variable in <b>snmptt.ini</b> to <b>ALL</b> (no quotes) to force all
MIBS to be initialized at SNMPTT startup. <br>
&nbsp;</p>
    </blockquote>
  </blockquote>
  <b>EXEC:</b>
  <blockquote>[<b>EXEC</b> command_string]
    <p>Optional string containing command to execute when trap is
received and arguments to pass to the program. </p>
    <p>EXEC uses the same variable substitution as the FORMAT line. </p>
    <p>Example: </p>
    <blockquote>EXEC /usr/bin/qpage -f TRAP alex "$r: $x $X - NIC
switchover to slot $3, port $4 from slot $5, port $6"</blockquote>
or
    <blockquote>EXEC c:\snmp\pager netops "$r: $x $X - NIC switchover
to slot $3, port $4 from slot $5, port $6"</blockquote>
Note: Unlike the FORMAT line, nothing is prepended to the
message.&nbsp; If you would like to include the hostname and date in the
page above, you must use the variables such as $r, $x and $X.</blockquote>
  <b>NODES:</b>
  <blockquote>[<b>NODES</b> sources_list]
    <p>Optional string containing a list of source (host) names
separated by spaces that must match for this trap handle definition to
be used.&nbsp; If this keyword omitted then ALL sources will be
accepted. </p>
    <p>Optionally a file can be specified which will contain the list
of sources.&nbsp; This file is loaded each time a trap is processed, so
the file can be modified without restarting SNMPTT.<br>
    </p>
    <p>This list must be specified with a full path </p>
    <p>Examples: </p>
    <blockquote>NODES fred barney betty wilma <br>
NODES /etc/snmptt-nodes <br>
&nbsp; or <br>
NODES c:\snmp\snmptt-nodes</blockquote>
where snmptt-nodes contains:
    <blockquote>fred <br>
barney <br>
# comment lines <br>
192.168.1.1 <br>
192.168.2.1 <br>
betty <br>
wilma</blockquote>
Notes:
    <blockquote>The names are NOT case sensitive, comment lines are
permitted by starting the line with a # and IP addresses can also be
used.
      <p>If you are using DNS, the names may resolve to the Fully
Qualified Domain Name (FQDN) by snmptrapd which could prevent matches
from occuring.&nbsp; For example: barney.bedrock.com. </p>
      <p>Adding an entry for the host in your /etc/hosts file or
c:\%systemroot%\system32\drivers\etc\hosts may result in snmptrapd
sending the short name instead (barney).&nbsp; You can also enable the <b>strip_domain</b>
/ <b>strip_domain_list</b> options to have SNMPTT strip the domain of
any FQDN host.&nbsp; See the <span style="font-weight: bold;">snmptt.ini</span>
file for details.</p>
    </blockquote>
  </blockquote>
  <b>SDESC</b>
  <blockquote>[<b>SDESC</b>]
    <p>Optional start of a description.&nbsp; All text between this
line and the line EDESC will be ignored by snmptt. This section can be
used to enter comments about the trap for your own use.&nbsp; If you use
a SDESC, you MUST follow with a EDESC.</p>
  </blockquote>
  <b>EDESC</b>
  <blockquote>[<b>EDESC</b>]
    <p>Used to end the description section. </p>
    <p>Example: </p>
    <blockquote>SDESC <br>
Trap used when power supply fails in <br>
a server. <br>
EDESC</blockquote>
  </blockquote>
</blockquote>
<p><br>
<a name="SNMPTT.CONF-Configuration-file-Notes"></a><b><font size="+2">SNMPTT.CONF
Configuration file Notes</font></b> </p>
<p>When there are multiple definitions of the same trap in the
configuration file, the following rules apply: </p>
<p><b>A match occurs when:</b> </p>
<ul>
  <li> The received trap OID matches a defined OID in the configuration
file</li>
  <li> <b>AND</b> <b>( </b>the hostname matches a defined hostname in
the NODES entry <b>OR</b> the NODES entry is blank<b>)</b></li>
</ul>
<b>If multiple_event is set to 1 in snmptt.ini:</b>
<ul>
  <li> A trap is handled as many times as it matches in the
configuration file</li>
  <li> If any number of exact matches exist, the wildcard match is NOT
performed</li>
  <li> If an exact match does NOT exist, the wildcard match IS performed
if the hostname matches a defined hostname in the NODES entry <b>OR</b>
the NODES entry is blank</li>
</ul>
<b>If multiple_event is set to 0 in snmptt.ini:</b>
<ul>
  <li> A trap is handled once using the first match in the configuration
file</li>
  <li> If an exact match exists, the wildcard match is NOT performed</li>
  <li> If an exact match does NOT exist, the wildcard match IS
performedifthe hostname matches a defined hostname in the NODES entry <b>OR</b>
the NODES entry is blank</li>
</ul>
<br>
<a name="Sample1-SNMPTT.CONF-file"></a><b><font size="+2">Sample1
SNMPTT.CONF file</font></b>
<p>Note: The <span style="font-weight: bold;">examples </span>folder
also contains a sample <span style="font-weight: bold;">snmptt.conf</span>
file.<br>
</p>
<p>Following is a sample of two defined traps in <b>snmptt.conf:</b> </p>
<blockquote># <br>
EVENT COMPAQ_11003 .1.3.6.1.4.1.232.0.11003 "LOGONLY" Normal <br>
FORMAT Compaq Generic Trap: $* <br>
EXEC qpage -f TRAP notifygroup1 "Compaq Generic Trap: $*" <br>
NODES /etc/snmp/cpqnodes <br>
SDESC <br>
Generic test trap <br>
EDESC <br>
# <br>
# <br>
EVENT cpqDa3AccelBatteryFailed .1.3.6.1.4.1.232.0.3014 "Error Events"
Critical <br>
FORMAT Battery status is $3. <br>
EXEC qpage -f TRAP notifygroup1 "$s $r $x $X: Battery status is $3" <br>
NODES ntserver1 ntserver2 ntserver3 <br>
# <br>
#</blockquote>
<a name="Sample2-SNMPTT.CONF-file"></a><b><font size="+2">Sample2
SNMPTT.CONF file</font></b>
<p>Following is a sample of a list of files to load in <b>snmptt.ini:</b> </p>
<blockquote>snmptt_conf_files = &lt;&lt;END <br>
/etc/snmp/snmp-compaq.conf <br>
/etc/snmp/snmp-compaq-hsv.conf <br>
END</blockquote>
Following is a sample of one defined traps in <b>/etc/snmp/snmptt-compaq.conf:</b>
<blockquote># <br>
EVENT COMPAQ_11003 .1.3.6.1.4.1.232.0.11003 "LOGONLY" Normal <br>
FORMAT Compaq Generic Trap: $* <br>
EXEC qpage -f TRAP notifygroup1 "Compaq Generic Trap: $*" <br>
NODES /etc/snmp/cpqnodes <br>
SDESC <br>
Generic test trap <br>
EDESC <br>
#</blockquote>
Following is a sample of one defined traps in <b>/etc/snmp/snmptt-compaq-hsv.conf:</b>
<blockquote># <br>
EVENT mngmtAgentTrap-16025 .1.3.6.1.4.1.232.0.136016025 "Status Events"
Normal <br>
FORMAT Host $1 : SCellName-TimeDate $2 : EventCode $3 : Description $4 <br>
EXEC qpage -f TRAP notifygroup1 "Host $1 : SCellName-TimeDate $2 :
EventCode $3 : Description $4" <br>
SDESC <br>
"Ema EMU Internal State Machine Error [status:10]" <br>
EDESC <br>
#</blockquote>
<p><br>
<a name="Notes"></a><b><font size="+2">Notes</font></b> </p>
<p>An existing HP Openview trapd.conf can be used in most cases but the
file must be a VERSION 3 file.&nbsp; SNMPTT does not support all the
variables implemented in HPOV, but most are available.&nbsp; The
following variables may or may not match exactly to HPOV: $O, $o, $r,
$ar, $R, $aR. </p>
<p>Some vendors (such as Compaq and Cisco ) provide a file that can be
imported in to HP Openview using an HP Openview utility.&nbsp; <span
 style="font-weight: bold;">Snmpttconvert </span>can be used to
convert the file to <span style="font-weight: bold;">snmptt.conf</span>
format. </p>
<p>Some vendors provide a MIB file that contains TRAP or NOTIFICATION
definitions.&nbsp; <span style="font-weight: bold;">Snmpttconvertmib </span>can
be used to convert the file to <span style="font-weight: bold;">snmptt.conf</span>
format. <br>
&nbsp; </p>
<p><a name="Installation-Unix"></a><b><font size="+2">Installation -
Unix</font></b> </p>
<p>1.&nbsp; <b><u>Read this entire file to understand how snmptt works</u></b> </p>
<p>2.&nbsp; Copy <b>snmptt</b> to <span style="font-weight: bold;">/usr/sbin/</span>
and ensure it is executable (<b>chmod +x snmptt</b>) </p>
<p>3.&nbsp; Copy <b>snmptthandler</b> to <span
 style="font-weight: bold;">/usr/sbin/</span> and ensure it is
executable (<b>chmod +x snmptthandler</b>) </p>
<p>4.&nbsp; Copy <b>snmptt.ini</b> to <b>/etc/snmp/ </b>or <span
 style="font-weight: bold;">/etc/</span> and edit the options inside the
file. </p>
<p>5a.&nbsp;&nbsp; For <b>standlone mode:&nbsp; </b>Modify the
NET-SNMP <span style="font-weight: bold;">snmptrapd.conf</span> file by
adding the following line: </p>
<blockquote><b>traphandle default /usr/sbin/snmptt</b>
  <p>Note:&nbsp;&nbsp; It is possible to configure snmptrapd to execute <span
 style="font-weight: bold;">snmptt </span>based on the specific trap
received, but using the <span style="font-weight: bold;">default </span>option
is preferred</p>
</blockquote>
5b.&nbsp;&nbsp; For <b>daemon mode:&nbsp;</b> Modify the NET-SNMP
snmptrapd.conf file by adding the following line:
<blockquote><b>traphandle default /usr/sbin/snmptthandler</b>
  <p>Launch snmptt using: </p>
  <p><b>snmptt --daemon</b></p>
</blockquote>
<blockquote>A startup script is included which can be used to start and
stop <b>snmptt</b> on Mandrake, RedHat and other systems.&nbsp; Copy the
script to the init.d directory (renaming the file during the copy):
  <p><b>cp snmptt.init.d to /etc/rc.d/init.d/snmptt</b> </p>
  <p>Add the service using <span style="font-weight: bold;">chkconfig</span>:</p>
  <p><b>chkconfig --add snmptt</b> </p>
  <p>Configure the service to start at runlevel 2345: </p>
  <p><b>chkconfig --level 2345 snmptt on</b> </p>
  <p>Snmptt will be started at the next reboot, or can be started
immediately with: </p>
  <p><b>service snmptt start</b> </p>
  <p>or </p>
  <p><b>/etc/rc.d/init.d/snmptt start</b></p>
</blockquote>
6.&nbsp; Start <span style="font-weight: bold;">snmptrapd </span>using
the command line:&nbsp; <span style="font-weight: bold;">snmptrapd -On</span>.<br>
&nbsp;&nbsp;&nbsp;&nbsp; You should be able to edit the <b>/etc/rc.d/init.d/snmptrapd</b>
script if you have one and change <br>
&nbsp;&nbsp;&nbsp;&nbsp; the <b>OPTIONS</b> to <b>"-On"</b>. <b>The
-On is required otherwise snmptt will NOT recognize the traps.</b>
<p>&nbsp;&nbsp;&nbsp;&nbsp; As an alternative, you can edit your <b>snmp.conf</b>
file to include the line: <b>printNumericOids 1.&nbsp; </b>This
setting will take effect no matter what is used on the command line. </p>
<p><a name="Installation-Windows"></a><b><font size="+2">Installation -
Windows</font></b> </p>
<p>1.&nbsp; <b><u>Read this entire file to understand how snmptt works</u></b> </p>
<p>2.&nbsp; Create the directory <span style="font-weight: bold;">c:\snmp</span>
and copy <b>snmptt</b> and <b>snmptthandler</b> to it.&nbsp; </p>
<p>3.&nbsp; Copy <b>snmptt.ini-nt</b> to <b>%SystemRoot%\snmptt.ini</b>
(c:\winnt\snmptt.ini)<b> </b>and edit the options inside the file. </p>
<p>4a.&nbsp;&nbsp; For <b>standlone mode:&nbsp; </b>Modify the
NET-SNMP snmptrapd.conf file by adding the following line: </p>
<blockquote><b>traphandle default perl c:\snmp\snmptt</b></blockquote>
<blockquote>Note:&nbsp;&nbsp; It is possible to configure snmptrapd to
execute snmptt based on the specific trap received, but using the <span
 style="font-weight: bold;">default </span>option is preferred</blockquote>
4b.&nbsp;&nbsp; For <b>daemon mode:&nbsp;</b> Modify the NET-SNMP
snmptrapd.conf file by adding the following line:
<blockquote><b>traphandle default perl c:\snmp\snmptthandler</b>
  <p>Launch snmptt using: </p>
  <p><b>snmptt --daemon</b></p>
</blockquote>
5.&nbsp; Start SNMPTRAPD using the command line:&nbsp; SNMPTRAPD -On. <b>The
-On is required otherwise snmptt will NOT recognize the traps.</b>
<p>&nbsp;&nbsp;&nbsp;&nbsp; As an alternative, you can edit your <b>snmp.conf</b>
file to include the line: <b>printNumericOids 1.&nbsp; </b>This
setting will take effect no matter what is used on the command line. </p>
<p><b><u><font size="+1">Windows NT EventLog:</font></u></b> </p>
<p>If you have enabled Windows Event Log support, then you must install
an Event Message File to prevent "Event Message Not Found" messages from
appearing in the Event Log.&nbsp; Microsoft Knowledge Base article
KB166902 contains information on this error. </p>
<p>The Event Message File is a binary DLL file.&nbsp; Included with
SNMPTT is a pre-compiled binary.&nbsp; To compile the DLL yourself, see
'Compiling' below. </p>
<p>To install the DLL: </p>
<ol>
  <li> Backup your system</li>
  <li> Make sure Event Viewer is not open</li>
  <li> Copy <b>bin\snmptt-eventlog.dll</b> to <b>%windir%\system32</b></li>
  <li> Launch the Registry Editor</li>
  <li> Go to '<b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Eventlog\Application</b>'</li>
  <li> Create a new subkey (under Application) called <b>SNMPTT</b></li>
  <li> Inside of the <b>SNMPTT</b> key, create a new <span
 style="font-weight: bold;">String </span>Value called <b>EventMessageFile</b>.&nbsp;
Give it a value of <b>%windir%\system32\snmptt-eventlog.dll</b></li>
  <li> Inside of the <b>SNMPTT</b> key, create a new <span
 style="font-weight: bold;">DWORD </span>Value called <b>TypesSupported</b>.&nbsp;
Give it a vlue of <b>7</b></li>
</ol>
To un-install the DLL:
<ol>
  <li> Backup your system</li>
  <li> Make sure Event Viewer is not open</li>
  <li> Launch the Registry Editor</li>
  <li> Go to '<b>HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\Eventlog\Application</b>'</li>
  <li> Delete the key <b>SNMPTT</b></li>
  <li> Delete the file <b>%windir%\system32</b></li>
</ol>
Compiling snmptt-eventlog.dll (MS Visual C++ required)
<ol>
  <li> If your environment is not already set up for command line
compilation, locate <b>vcvars32.bat</b>, start a command prompt, and
execute it (<span style="font-weight: bold;">vcvars32.bat</span>).<br>
  </li>
  <li> cd into the directory where <span style="font-weight: bold;">snmptt-eventlog.mc</span>
is located (included with SNMPTT) and execute the following commands:</li>
  <li> <b>mc snmptt-eventlog.mc</b></li>
  <li> <b>rc /r snmptt-eventlog.rc</b></li>
  <li> <b>link /nodefaultlib /INCREMENTAL:NO /release /nologo
-base:0x60000000 -machine:i386 -dll -noentry -out:snmptt-eventlog.dll
snmptt-eventlog.res</b></li>
  <li> Install the DLL as described above</li>
</ol>
<p><br>
<b><u><font size="+1">Windows NT Service:</font></u></b> </p>
<p>To configure SNMPTT as a service under Windows NT, follow these
steps.&nbsp; More information can be obtained from the Windows NT
Resource Kit. </p>
<p>1.&nbsp;&nbsp;&nbsp; Install the Windows NT resource kit </p>
<p>2.&nbsp;&nbsp;&nbsp; Copy the <b>srvany.exe</b> program to <b>c:\winnt\system32</b>
from <b>c:\Program Files\Resource Kit *</b> </p>
<p>3.&nbsp;&nbsp;&nbsp; Install the SNMPTT service using: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b> instsrv SNMPTT
c:\winnt\system32\srvany.exe</b> </p>
<p>4.&nbsp;&nbsp;&nbsp; Configure the service: </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Launch <b>REGEDIT</b> </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Go to <b>HKLM\SYSTEM\CurrentControlSet\SNMPTT</b> </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Create a key called: <b>Parameters</b> </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inside of Parameters,
create a Sting Value (REG_SZ) called <b>Application</b> with the value
of: <b>c:\perl\bin\perl.exe</b> </p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Inside of Parameters,
create a Sting Value (REG_SZ) called <b>AppParameters</b> with the value
of: <b>c:\snmp\snmptt --daemon</b> </p>
<p>5.&nbsp;&nbsp;&nbsp; Start the service from the control panel, or
from a command prompt, type:&nbsp; <b>net start snmptt</b> </p>
<p>To remove the service, type:&nbsp; <b>instsrv SNMPTT remove</b> <br>
&nbsp; </p>
<p><a name="Limitations"></a><b><font size="+2">Limitations</font></b> </p>
<p><b><font size="+1">Standalone mode only:</font></b> </p>
<p>With a 450 Mhz PIII and a 9000 line snmptt.conf containing 566
unique traps (EVENTs), it takes under a second to process the trap
including logging and executing the qpage program.&nbsp; The larger the
snmptt.conf file is, the longer it will take to process.&nbsp; If there
are a large number of traps being received, daemon mode should be
used.&nbsp; If it takes 1 second to process one trap, then obviously you
shouldn't try to process more than one trap per second.<br>
</p>
<p>Note: Enabling the UCD-SNMP / Net-SNMP Perl module will greatly
increase the startup time of SNMPTT.&nbsp; Daemon mode is recommended. </p>
<p><b><font size="+1">Standalone or daemon mode:</font></b> </p>
<p>The SNMPTRAPD program blocks when executing traphandle
commands.&nbsp; This means that if the program called never quits,
SNMPTRAPD will wait forever.&nbsp; If a trap is received while the
traphandler is running, it is buffered and will be processed when the
traphandler finishes.&nbsp; I do not know how large this buffer is. </p>
<p>The program called by SNMPTT (EXEC) blocks SNMPTT.&nbsp; If you call
a program that does not return, SNMPTT will be left waiting.&nbsp; In
standalone mode, this would cause snmptrapd to wait forever also. <br>
&nbsp; </p>
<p><a name="Feedback"></a><b><font size="+2">Feedback &amp; Bugs</font></b> </p>
<p>Please send me any comments - good or bad - to
alex_b@users.sourceforge.net.&nbsp; If you have any problems including
converting trap files, please send me an email and include the file you
are trying to convert and I will try to take a look at it. </p>
<p>Please also send any bug reports, patches or improvements so I can
fix / add them and add it to the next release.&nbsp; You can also use
Sourceforge for <a
 href="http://sourceforge.net/tracker/?group_id=51473&amp;atid=463393">bugs</a>
and <a
 href="http://sourceforge.net/tracker/?atid=463396&amp;group_id=51473&amp;func=browse">feature
requests</a>. <br>
&nbsp; </p>
<p><a name="SNMP-Trap-Translator-Convert"></a><b><font size="+3">SNMP
Trap Translator Convert v0.2</font></b> <br>
<b><font size="+1">(SNMPTTCONVERT)</font></b> </p>
<p>Some vendors provide a file that can be imported into HP Openview
using a HP Openview utiltity.&nbsp; <span style="font-weight: bold;">SNMPTTCONVERT</span>is
a simple Perl script which will convert one of these files into the
format used by SNMPTT.&nbsp; The file can contain multiple traps. </p>
<p>For example, if the file ciscotrap.txt contained: </p>
<blockquote>rpsFailed {.1.3.6.1.4.1.437.1.1.3} 6 5 - "Status Events" 1 <br>
Trap received from enterprise $E with $# arguments: sysName=$1 <br>
SDESC <br>
"A redundant power source is connected to the switch but a failure
exists in <br>
the power system." <br>
EDESC</blockquote>
Executing snmpttconvert ciscotrap.txt would output:
<blockquote># <br>
# <br>
# <br>
EVENT rpsFailed .1.3.6.1.4.1.437.1.1.3.0.5 "Status Events" Normal <br>
FORMAT Trap received from enterprise $E with $# arguments: sysName=$1 <br>
#EXEC qpage -f TRAP notifygroup1 "Trap received from enterprise $E with
$# arguments: sysName=$1" <br>
SDESC <br>
"A redundant power source is connected to the switch but a failure
exists in <br>
the power system." <br>
EDESC</blockquote>
<p><br>
Note:&nbsp; The #EXEC line is added by default.&nbsp; This can be
changed by editing the SNMPTTCONVERT script. <br>
&nbsp; </p>
<p><a name="SNMP-Trap-Translator-Convert-MIB"></a><b><font size="+3">SNMP
Trap Translator Convert MIB v0.2</font></b><br>
<b><font size="+1">(SNMPTTCONVERTMIB)</font></b> </p>
<p><b>SNMPTTCONVERTMIB</b> is a Perl script which will read a MIB file
and convert the <b>TRAP-TYPE</b> (v1) or <b>NOTIFICATION-TYPE</b> (v2)
definitions into a configuration file readable by <b>SNMPTT</b>. </p>
<p>For example, if the file <b>CPQHOST.mib</b> (v1) contained: </p>
<blockquote>CPQHOST-MIB DEFINITIONS ::= BEGIN
  <p>&nbsp;&nbsp;&nbsp; IMPORTS <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
enterprises&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
FROM RFC1155-SMI <br>
. <br>
. <br>
. (lines removed) <br>
. <br>
. <br>
&nbsp;&nbsp;&nbsp; cpqHo2NicSwitchoverOccurred2 TRAP-TYPE <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ENTERPRISE compaq <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; VARIABLES { sysName,
cpqHoTrapFlags, cpqHoIfPhysMapSlot, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cpqHoIfPhysMapPort, cpqHoIfPhysMapSlot, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
cpqHoIfPhysMapPort } <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; DESCRIPTION <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"This trap will be sent any time the configured redundant NIC <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
becomes the active NIC." </p>
  <p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
--#TYPE "Status Trap" <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
--#SUMMARY "NIC switchover to slot %s, port %s from slot %s, port %s." <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
--#ARGUMENTS {2, 3, 4, 5} <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
--#SEVERITY MAJOR <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
--#TIMEINDEX 99 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ::= 11010 <br>
&nbsp;</p>
</blockquote>
Executing <b>snmpttconvertmib CPQHOST.mib snmptt.conf </b>would
APPEND to the end of the <b>snmptt.conf</b> file (specified on the
command line):
<blockquote># <br>
# <br>
# <br>
EVENT cpqHo2NicSwitchoverOccurred2 .1.3.6.1.4.1.232.0.11010 "Status
Events" Normal <br>
FORMAT Status Trap: NIC switchover to slot $3, port $4 from slot $5,
port $6. <br>
#EXEC qpage -f TRAP notifygroup1 "Status Trap: NIC switchover to slot
$3, port $4 from slot $5, port $6." <br>
SDESC <br>
This trap will be sent any time the configured redundant NIC <br>
becomes the active NIC. <br>
EDESC</blockquote>
<p><br>
Notes: </p>
<blockquote>The #EXEC line is added by default.&nbsp; This can be
changed by editing the <b>SNMPTTCONVERTMIB</b> script.
  <p>To prevent the --#TYPE text from being prepended to the --#SUMMARY
line, change <b>$prepend_type</b> to <b>0</b> in the <b>SNMPTTCONVERTMIB</b>
script.</p>
</blockquote>
<p><br>
<b><font size="+2">Requirements</font></b> </p>
<ul>
  <li> UCD-SNMP / NET-SNMP <a
 href="http://www.net-snmp.org/man/snmptranslate.html"><b>snmptranslate</b></a>
utility</li>
</ul>
<div style="margin-left: 40px;">or</div>
<ul>
  <li> UCD-SNMP / NET-SNMP <b style="font-weight: bold;"><a
 href="http://www.net-snmp.org/FAQ.html#Where_can_I_get_the_perl_SNMP_package_">Perl
module</a></b><br>
  </li>
</ul>
<p><br>
<b><font size="+2">Converting a MIB file</font></b> </p>
<p>Follow these steps to successfully convert a MIB file: <br>
&nbsp; </p>
<ol>
  <li> Edit the options between OPTIONS START and OPTIONS END in
snmpttconvertmib</li>
  <li> Copy the MIB file to UCD-SNMP / NET-SNMP mibs folder</li>
  <li> Type: <b>export MIBS=ALL</b> to ensure all the mibs will be read
in by <b>snmptranslate</b></li>
  <li> Make sure the MIB file can be interpreted by <b>snmptranslate</b>
correctly.&nbsp; Simply typing <b>snmptranslate</b> should tell you if
it was able to read the mib file correctly.&nbsp; If it can't, an error
will be produced at the top of the help screen.</li>
  <li> If you are using <b>UCD-SNMP</b>, or <b>NET-SNMP v5.0.<span
 style="text-decoration: underline;">1</span></b>, then add the
folllowing to your snmp.conf file: <b>printNumericOids 1</b>
(note:&nbsp; this will affect all snmp commands).&nbsp; This ensures the
OIDs are returned in numerical format.&nbsp; Other versions of NET-SNMP
do not require this change, as <b>snmpttconvertmib</b> will use a
command line switch to force it on when calling <b>snmptranslate</b>.</li>
  <li> Convert the mib file with: <b>snmpttconvertmib --in=<i>path-to-mib</i>
--out=<i>output-file-name</i></b>.&nbsp; Note:&nbsp; the <b>output-file-name</b>
is appended to, so remember to delete it first if needed.&nbsp; To use
the Perl module instead of snmptranslate, use: <b>snmpttconvertmib --in=<i>path-to-mib</i>
--out=<i>output-file-name</i> --net_snmp_perl --mibdir=</b><b><i>path-to-mib-directory</i></b></li>
</ol>
Example:
<blockquote><b>snmpttconvertmib --in=/usr/share/snmp/mibs/CPQHOST.mib
--out=/etc/snmp/snmptt-compaqhost.conf<br>
  <br>
  </b><b>snmpttconvertmib --in=/usr/share/snmp/mibs/CPQHOST.mib
--out=/etc/snmp/snmptt-compaqhost.conf --net_snmp_perl
--mibdir=/usr/share/snmp/mibs</b><br>
</blockquote>
<p>Note:&nbsp; <br>
</p>
<div style="margin-left: 40px;">Use <span style="font-weight: bold;">snmpttconvertmib
-h</span> for more options.<br>
<br>
Using either the <span style="font-weight: bold;">snmptranslate</span>
or the <span style="font-weight: bold;">Perl module</span> should
produce the exact same output, but the Perl module should be
faster.&nbsp; The order of the output may be different as the Perl
module will output based on a sorted list of OIDs contained in the MIB
file, while the snmptranslate method will process the MIB from top to
bottom.<br>
</div>
<p><b><font size="+2">How it works</font></b> <br>
&nbsp; </p>
<p><b><font size="+1">SNMP V1 files (TRAP-TYPE) - snmptranslate
(default) method:</font></b> </p>
<p>Some MIB files contain <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b>
lines which are used by Novell's Network Management system.&nbsp; These
MIB files convert very well to <b>SNMPTT</b> as they contain detailed
information that can be used on the <b>FORMAT</b> and <b>EXEC</b>
lines.&nbsp; Compaq's MIBs usually have these lines. </p>
<p>Other MIBS contain only a <b>DESCRIPTION</b> section where the first
line contains the <b>FORMAT</b> string.&nbsp; In some MIBS, this line
also contains variables similar to the <b>--#SUMMARY</b> lines. </p>
<p>The mib file is searched for lines containing <b>TRAP-TYPE</b>.&nbsp;
If it finds one that appears to be a valid trap definition, it reads in
the following lines until a ::= is found while looking for the <b>ENTERPRISE</b>
and <b>DESCRIPTION</b> section.&nbsp; It then looks for the <b>--#SUMMARY</b>
and <b>--#ARGUMENTS</b> line. </p>
<p>The value for the <b>ENTERPRISE</b> is used when looking up the <b>TRAP-TYPE</b>.<b>SNMPTRANSLATE</b>
is used with the following syntax to find the <b>OID</b> of the trap: </p>
<p><b>snmptranslate -IR -Ts <i>enterprise</i>#.<i>trapname</i></b> </p>
<p>Note: If&nbsp; NET-SNMP 5.0.2 or newer is detected, the command line
also includes the -On switch.&nbsp; See the <a
 href="file:///h:/cvs/snmptt/readme.html#FAQ-Troubleshooting">FAQ</a>.</p>
<p>MIB files can become quite complex to read due to the use of IMPORT
statements etc.&nbsp; This is why snmptranslate is used. </p>
<p>If <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> are found, the <b>%<i>letter</i></b>
variables are replaced with <b>$<i>number</i></b> variables based on the
values lists in the <b>--#ARGUMENTS</b> section incremented by 1
(ARGUMENTS starts with 0, SNMPTT starts with 1).&nbsp; This will be used
to define the <b>FORMAT</b> and <b>EXEC</b> lines. </p>
<p>If there is no <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> lines, but
the first line of the <b>DESCRIPTION</b> contains <b>%<i>letter</i></b>
variables, then that line will be used to define the <b>FORMAT</b> and <b>EXEC</b>
lines.&nbsp; The <b>%<i>letter</i></b> variables are replaced with <b>$<i>number</i></b>
variables starting at 1 and going up. </p>
<p>If there is no <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> lines, and
the first line of the <b>DESCRIPTION</b> does not contain <b>%<i>letter</i></b>
variables, then that line will be used to define the <b>FORMAT</b> and <b>EXEC</b>
lines followed by a <b>$*</b> which will dump all received variables. <br>
</p>
<p><b><font size="+1">SNMP V1 files (TRAP-TYPE) - Perl module method:</font></b> <br>
</p>
<p>When the Perl module is used, the only differences are:<br>
</p>
<ol>
  <li>The MIB file is also loaded into memory using the Perl module</li>
  <li>A loop goes through all the TRAP / NOTIFICATIONS</li>
  <li>For each one, the MIB file is parsed using the same method above
for the DESCRIPTION and SUMMARY text</li>
  <li>Snmptranslate is not used as the Perl module already contains the
OID of the trap / notification</li>
  <li>The conversion should be considerably quicker than using <span
 style="font-weight: bold;">snmptranslate</span><br>
  </li>
</ol>
Note:<br>
<div style="margin-left: 40px;">The Perl module has the ability to
extract the desription from the MIB file, but it does not include the
--#SUMMARY lines as they appear as comments.&nbsp; Because of this, the
description and summary lines are extracted handled manually.<br>
</div>
<p><b><font size="+1">SNMP V2 files (NOTIFICATION-TYPE) </font></b><b><font
 size="+1">- snmptranslate (default) method:</font></b><b><font
 size="+1">:</font></b> </p>
<p>The mib file is searched for lines containing <b>NOTIFICATION-TYPE</b>.&nbsp;
If it finds one that appears to be a valid trap definition, it reads in
the following lines until a ::= is found while looking for the <b>DESCRIPTION</b>
section. It then looks for the <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b>
line.&nbsp; I have never seen a V2 file with the&nbsp; <b>--#SUMMARY</b>
and <b>--#ARGUMENTS</b> lines in them, but I have left the code in place
in case they exist. </p>
<p>The value for the <b>ENTERPRISE</b> is used when looking up the <b>NOTIFICATION-TYPE</b>.<b>SNMPTRANSLATE</b>
is used with the following syntax to find the <b>OID</b> of the trap: </p>
<p><b>snmptranslate -IR -Ts <i>enterprise</i>.<i>trapname</i></b> </p>
<p>Note: If&nbsp; NET-SNMP 5.0.2 or newer is detected, the command line
also includes the -On switch.&nbsp; See the <a
 href="#FAQ-Troubleshooting">FAQ</a>.<br>
</p>
<p>MIB files can become quite complex to read due to the use of IMPORT
statements etc.&nbsp; This is why snmptranslate is used. </p>
<p>If <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> are found, the <b>%<i>letter</i></b>
variables are replaced with <b>$<i>number</i></b> variables based on the
values lists in the <b>--#ARGUMENTS</b> section incrememented by 1
(ARGUMENTS starts with 0, SNMPTT starts with 1).&nbsp; This will be used
to define the <b>FORMAT</b> and <b>EXEC</b> lines. </p>
<p>If there is no <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> lines, but
the first line of the <b>DESCRIPTION</b> contains <b>%<i>letter</i></b>
variables, then that line will be used to define the <b>FORMAT</b> and <b>EXEC</b>
lines.&nbsp; The <b>%<i>letter</i></b> variables are replaced with <b>$<i>number</i></b>
variables starting at 1 and going up. </p>
<p>If there is no <b>--#SUMMARY</b> and <b>--#ARGUMENTS</b> lines, and
the first line of the <b>DESCRIPTION</b> does not contain <b>%<i>letter</i></b>
variables, then that line will be used to define the <b>FORMAT</b> and <b>EXEC</b>
lines followed by a <b>$*</b> which will dump all received variables. <br>
&nbsp;<br>
<b><font size="+1">SNMP V2 files (</font></b><b><font size="+1">NOTIFICATION</font></b><b><font
 size="+1">-TYPE) - Perl module method:</font></b> <br>
</p>
<p>When the Perl module is used, the only differences are:<br>
</p>
<ol>
  <li>The MIB file is also loaded into memory using the Perl module</li>
  <li>A loop goes through all the TRAP / NOTIFICATIONS</li>
  <li>For each one, the MIB file is parsed using the same method above
for the DESCRIPTION and SUMMARY text</li>
  <li>Snmptranslate is not used as the Perl module already contains the
OID of the trap / notification</li>
  <li>The conversion should be considerably quicker than using <span
 style="font-weight: bold;">snmptranslate</span><br>
  </li>
</ol>
Note:<br>
<div style="margin-left: 40px;"> The Perl module has the ability to
extract the desription from the MIB file, but it does not include the
--#SUMMARY lines as they appear as comments.&nbsp; Because of this, the
description and summary lines are extracted handled manually.</div>
<p><br>
</p>
<p><a name="FAQ-Troubleshooting"></a><b><font size="+3">Faq /
Troubleshooting</font></b> </p>
<p><b>Q: Are there any sample files to get me started?<br>
</b></p>
A:&nbsp; Yes, the examples folder contains a sample snmptt.conf file,
and a sample trap file for testing.<br>
<ol>
  <li>Install SNMPTT as described in this document</li>
  <li>Copy the <span style="font-weight: bold;">snmptt.conf.generic</span>
file to the location specified in the snmptt.ini file (probably <span
 style="font-weight: bold;">/etc/snmp/</span> or <span
 style="font-weight: bold;">c:\snmp</span>)</li>
  <li>Add snmptt.conf.generic to the <span style="font-weight: bold;">snmptt_conf_files</span>section
of <span style="font-weight: bold;">snmptt.ini</span>.</li>
  <li>Test SNMPTT by typing:&nbsp; snmptt &lt; sample-trap.generic</li>
  <li>Check the logs files etc for a sample linkDown trap<br>
  </li>
</ol>
<p><b><br>
Q:&nbsp; SNMPTT is not working!&nbsp; How do I troubleshoot it?</b> </p>
<p>A:&nbsp; Start by enabling <span style="font-weight: bold;">enable_unknown_trap_log</span>in
the <span style="font-weight: bold;">snmptt.ini</span> file.&nbsp; Look
inside this file to see if the traps are being passed correctly to
SNMPTT but not being handled correctly.&nbsp; Next, enable debug mode of
2 and specify a debug text file to log to in the snmptt.ini file.&nbsp;
After a trap is received, take a look at the file to try to determine
what is going wrong.&nbsp; Disable both logs when you are finished. <br>
</p>
<p>To make troubleshooting a particular trap easier when working in
daemon mode, try the following:</p>
<ol>
  <li>Shut down SNMPTT</li>
  <li>Generate the trap</li>
  <li>Copy the resulting # file from the spool directory
(/var/spool/snmptt) to the /tmp directory as /tmp/test-trap<br>
  </li>
  <li>Edit the file, removing the first line (which is a large number
that contains the date / time)</li>
  <li>Run SNMPTT in standalone method using: <span
 style="font-weight: bold;">snmptt &lt; test-trap</span><br>
  </li>
  <li>Troubleshoot by using the log files etc<br>
  </li>
</ol>
<p><b><br>
Q:&nbsp; I have configured SNMPTT correctly with a snmptt.ini file,
snmptt.conf file(s) etc and it still does not process traps.&nbsp;
Everything appears in the snmpttunknowntrap.log file.&nbsp; What did I
do wrong?</b> </p>
<p>A:&nbsp; You probably didn't start snmptrapd correctly.&nbsp; Make
sure it is started using: </p>
<blockquote><b>snmptrapd -On</b></blockquote>
If it is not started with -On, then it will not pass traps using
numeric OIDs and SNMPTT will not process them.
<p>As an alternative, you can edit your <b>snmp.conf</b> file to
include the line: <b>printNumericOids 1.&nbsp; </b>This setting will
take effect no matter what is used on the command line. </p>
<p><br>
<b>Q:&nbsp; When I try to convert a MIB, it will not convert
properly.&nbsp; Why?</b> </p>
<p>A:&nbsp; If you are using Unix and transferred the MIB file from
Windows (or downloaded a ZIP file containing the MIB), you need to make
sure it does not contain DOS carriage returns.&nbsp; Displaying the file
with the <b>joe</b> text editor will show <b><u>M</u></b>'s at the end
of each line.&nbsp; To strip them out and craete a new file, type: </p>
<p><b>cat <i>mib-file</i> | tr -d '\015' &gt; <i>mib-file.new</i></b> <br>
&nbsp; </p>
<p><b>Q:&nbsp; I have disabled syslog support in SNMPTT, but my syslog
(or NT Event Log) is still filling up with trap messages.&nbsp; How do I
disable them?</b> <br>
<b>Q:&nbsp; I am using syslog (or NT Event Log) to log trap messages,
but there are two log entries for each trap received.&nbsp; How do I
prevent it?</b> </p>
<p>A:&nbsp; What you are seeing are <b>snmptrapd</b> trap messages, not
SNMPTT messages.&nbsp; SNMPTT trap messages start with '<b>TRAPD:</b>'
while snmptrapd messages start with '<b>snmptrapd[xxx]:</b>'.&nbsp; If
you do not start snmptrapd with either the <b>-P</b> or <b>-o</b>
(lowercase o) switches, syslog support will be forced on.&nbsp;
Snmptrapd should be started using '<b>snmptrapd -On</b>' and this
results in syslog being forced on.&nbsp; The reason for this is the
original design of snmptrapd assumed that if you are not going to
display messages on the screen or log to a file, then you must want
syslog output. </p>
<p>A workaround is to have snmptrapd log all messages to /dev/null, or
to a text file that can be regularily purged if needed.&nbsp; To log to
a text file, start snmptrapd using: </p>
<blockquote><b>snmptrapd -On -o /var/log/snmptrapd.log</b></blockquote>
This will cause <b>ALL</b> snmptrapd messages to be logged to the file
which means all snmptrapd 'system' messages such as startup and shutdown
will not be logged to syslog.
<p>A patch for NET-SNMP 5.0.7 is available that adds a new switch (-t)
to prevent TRAP messages from being logged to syslog, but allowing
system messages to continue to be logged.&nbsp; The patch is available
from the <a
 href="http://sourceforge.net/tracker/?func=detail&amp;atid=312694&amp;aid=695312&amp;group_id=12694">Net-SNMP
patch section</a>.&nbsp; This patch should be included in the 5.1 (not
5.0.8) release of NET-SNMP.&nbsp; With this patch, snmptrapd should be
started using: </p>
<blockquote><b>snmptrapd -On -t</b></blockquote>
<p><br>
<b>Q:&nbsp; I want to enable the Perl support for UCD-SNMP / NET-SNMP
under Linux, but I installed UCD-SNMP / NET-SNMP using RPMs.&nbsp;
What's the easiest way to install the module without recompiling
everything?</b> </p>
<p>A:&nbsp; You should not have to re-compile the entire package.&nbsp;
Try the following: </p>
<ol>
  <li> Download the source RPM that matches the binary RPM you
downloaded.&nbsp; For example: ucd-snmp-4.2.3-1.src.rpm</li>
  <li> Install the RPM</li>
  <li> Locate the installed source code.&nbsp; For Mandrake, it should
be in /usr/src/RPM/SOURCES</li>
  <li> Go into the sub directory perl/SNMP</li>
  <li> Follow the instructions in the README file</li>
</ol>
<p><b><br>
<span style="font-weight: bold;">Q:&nbsp; I want to enable the Perl
support for UCD-SNMP / NET-SNMP under Windows</span></b><span
 style="font-weight: bold;"> but I don't know how.&nbsp; Do you?</span><br>
</p>
<p>A:&nbsp; If I ever find someone who has managed to get it to compile
under a newer Net-SNMP, I will add the steps in here.<br>
<br>
</p>
<p> <b>Q:&nbsp; I have enable net_snmp_perl_enable but the variable
names are not being translated into text using $v<i>n, $-n, $+n, $-* or
$+*</i>.&nbsp; How do I troubleshoot it?</b> <br>
<b>Q:&nbsp; I have enabled translate_integers but the integer values
are not being translated into text.&nbsp;&nbsp; How do I troubleshoot it?</b> </p>
<p>A:&nbsp; You must have the UCD-SNMP / NET-SNMP Perl module installed
and working, and must ensure UCD-SNMP / NET-SNMP is configured correctly
with all the required MIBS. </p>
<p>For starters, make sure the SNMP module is working.&nbsp; Type: </p>
<blockquote>perl <br>
use SNMP;</blockquote>
If you get an error after typing 'use SNMP', then the module is not
installed correctly.&nbsp; Re-install the module and make sure you
execute the tests while building.
<p>If the MIB files are present, but translations do not occur, ensure
UCD-SNMP / NET-SNMP is correctly configured to process all the required
mibs.&nbsp; This is configured in the snmp.conf file.&nbsp;
Alternatively, you can try setting the <b>mibs_enviroment</b> variable
in snmptt.ini to <b>ALL</b> (no quotes) to force all MIBS to be
initialized at SNMPTT startup. </p>
<p>If everything appears to be fine, try translating the variable name
by hand by using snmptranslate.&nbsp; Get the variable name OID from the
snmptt.debug file from the second Value 0+ section, and type: </p>
<blockquote>snmptranslate -Td <i>oid</i></blockquote>
This should return the OBJECT-TYPE for the variable if it exists in a
MIB file
<p>If you are using UCD-SNMP v4.2.3, then the variables will not
translate properly because SNMPTRAPD does not pass them correctly to
SNMPTT.&nbsp; Upgrade to a newer version of snmptrapd. <br>
&nbsp; </p>
<p><b>Q:&nbsp; I converted a MIB using snmpttconvertmib (default
snmptranslate mode) but the OIDs are appearing as text instead of being
numberical.&nbsp; Why?</b> </p>
<blockquote><b>For example:</b></blockquote>
<blockquote><b>EVENT linkUp
.iso.org.dod.internet.snmpV2.snmpModules.snmpMIB.snmpMIBObjects.snmpTraps.linkUp
"Status Events" Normal</b>
  <p><b>instead of</b> </p>
  <p><b>EVENT linkUp .1.3.6.1.6.3.1.1.5.4 "Status Events" Normal</b></p>
</blockquote>
<p><br>
A:&nbsp; By default, <b>snmpttconvertmib</b> uses the <b>snmptranslate</b>
command to convert MIB files.&nbsp; With Net-SNMP v5.0.2 and newer,
setting the <b>-On</b> switch on the <b>snmptranslate</b> command causes
the output to be in numerical format, which is what is needed for <b>snmpttconvertmib</b>.</p>
<p>With Net-SNMP v5.0.1 and all versions of UCD-SNMP, setting the -On
switch will TOGGLE the setting of using numerical output.&nbsp; With
Net-SNMP v5.0.2 and newer, setting the -On switch will FORCE the output
to be numerical. </p>
<p><b>Snmpttconvermib</b> will use the<span style="font-weight: bold;">
-On</span> switch for <span style="font-weight: bold;">snmptranslate</span> <b>only</b>
if it detects anything but UCD-SNMP or Net-SNMP v5.0.1. </p>
<p>If you are using UCD-SNMP, or Net-SNMP v5.0.1, the best option is to
modify your <b>snmp.conf</b> file (for UCD-SNMP / Net-SNMP), and add or
modify the line: </p>
<blockquote><b>printNumericOids 1</b></blockquote>
This will cause all applications to output in numerical format
including <b>snmptranslate</b>.&nbsp; Note: This will affect other
UCD-SNMP / Net-SNMP programs you are using, if any. <br>
&nbsp;
<p><b>Q:&nbsp; Is there a front-end alarm browser available for SNMPTT?</b> </p>
<p>A:&nbsp; Take a look at <a
 href="http://sourceforge.net/projects/snmptt-gui">SNMPTT-GUI</a>.&nbsp;
SNMPTT-GUI aims to provide a web based frontend for SNMPTT.&nbsp; The
gui is made up of server side perl cgi scripts with client side
javascripts which interfaces to a SQL database using DBI::ODBC. </p>
<p>SNMPTT-GUI questions should be directed to the project admins on the <a
 href="http://sourceforge.net/projects/snmptt-gui/">SNMPTT-GUI
Sourceforge page</a>. <br>
&nbsp; <br>
</p>
&nbsp;<br>
<br>
<br>
<p><br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; <br>
&nbsp; </p>
</body>
</html>
